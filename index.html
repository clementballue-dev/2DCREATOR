<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal Personnel - Archives</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; background: #f0f2f5; overflow: hidden; }
        
        /* Sidebar */
        #sidebar { width: 260px; background: #1a1a2e; color: white; display: flex; flex-direction: column; flex-shrink: 0; }
        #sidebar h2 { text-align: center; color: #4cc9f0; padding: 25px; margin: 0; border-bottom: 1px solid #333; }
        .menu-item { padding: 15px 25px; cursor: pointer; transition: 0.3s; border-left: 4px solid transparent; }
        .menu-item:hover, .active { background: #252545; border-left: 4px solid #4cc9f0; color: #4cc9f0; }

        /* Contenu Principal */
        #main-wrapper { flex: 1; display: flex; flex-direction: column; }
        
        /* Barre du haut (Header) avec Calendrier */
        #top-bar { 
            background: white; padding: 15px 40px; border-bottom: 1px solid #ddd; 
            display: flex; justify-content: space-between; align-items: center; 
        }
        .calendar-container { display: flex; align-items: center; gap: 10px; font-weight: bold; color: #1a1a2e; }
        #date-picker { padding: 8px; border-radius: 5px; border: 1px solid #ccc; font-family: inherit; cursor: pointer; }

        #main-content { flex: 1; padding: 40px; overflow-y: auto; }
        .news-card { 
            background: white; padding: 25px; border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 20px; 
            position: relative; animation: fadeIn 0.4s;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        .news-card .badge { background: #4cc9f0; color: #1a1a2e; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        .delete-btn { position: absolute; top: 20px; right: 20px; background: #ff4d4d; color: white; border: none; border-radius: 5px; cursor: pointer; padding: 5px 10px; display: none; }

        /* Admin Panel */
        #admin-panel { 
            position: fixed; bottom: 80px; left: 20px; 
            background: #1a1a2e; color: white; padding: 20px; 
            border-radius: 12px; display: none; width: 220px; z-index: 100;
        }
        #admin-panel input, #admin-panel textarea, #admin-panel select { 
            width: 100%; margin-bottom: 10px; border-radius: 6px; border: none; padding: 10px; background: #0f0f1e; color: white; box-sizing: border-box;
        }
        #admin-toggle { position: fixed; bottom: 20px; left: 20px; background: #1a1a2e; color: #4cc9f0; border: 1px solid #4cc9f0; padding: 10px 15px; border-radius: 8px; cursor: pointer; z-index: 101; }
    </style>
</head>
<body>

    <div id="sidebar">
        <h2>JOURNAL</h2>
        <div class="menu-item active" onclick="changeCategory('Tout')">üè† Tout voir</div>
        <div class="menu-item" onclick="changeCategory('Sport')">‚öΩ Sport</div>
        <div class="menu-item" onclick="changeCategory('Tech')">üíª Tech</div>
        <div class="menu-item" onclick="changeCategory('Bourse')">üìà Bourse</div>
        <div class="menu-item" onclick="changeCategory('Jeux Vid√©o')">üéÆ Jeux Vid√©o</div>
        <div class="menu-item" onclick="changeCategory('Politique')">üèõÔ∏è Politique</div>
    </div>

    <div id="main-wrapper">
        <div id="top-bar">
            <h1 id="current-cat" style="margin:0; font-size: 1.5rem;">Toutes les infos</h1>
            <div class="calendar-container">
                <label for="date-picker">üìÖ Filtrer par date :</label>
                <input type="date" id="date-picker" onchange="renderNews()">
                <button onclick="resetDate()" style="padding: 8px; cursor:pointer;">Effacer</button>
            </div>
        </div>

        <div id="main-content">
            <div id="news-container"></div>
        </div>
    </div>

    <button id="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è G√©rer</button>

    <div id="admin-panel">
        <h3>Nouvel Article</h3>
        <select id="news-category">
            <option value="Sport">Sport</option>
            <option value="Tech">Tech</option>
            <option value="Bourse">Bourse</option>
            <option value="Jeux Vid√©o">Jeux Vid√©o</option>
            <option value="Politique">Politique</option>
        </select>
        <input type="text" id="news-title" placeholder="Titre...">
        <textarea id="news-text" placeholder="Texte..." rows="4"></textarea>
        <button onclick="postNews()" style="width:100%; background:#4cc9f0; border:none; padding:12px; cursor:pointer; font-weight:bold; border-radius:6px;">PUBLIER</button>
    </div>

    <script>
        let allNews = JSON.parse(localStorage.getItem('myJournalNews')) || [];
        let currentCategory = 'Tout';
        let isAdmin = false;

        function toggleAdmin() {
            if (prompt("Mot de passe :") === "1234") {
                isAdmin = !isAdmin;
                document.getElementById('admin-panel').style.display = isAdmin ? 'block' : 'none';
                renderNews();
            }
        }

        function postNews() {
            const cat = document.getElementById('news-category').value;
            const title = document.getElementById('news-title').value;
            const text = document.getElementById('news-text').value;
            
            // On enregistre la date au format YYYY-MM-DD pour le calendrier
            const now = new Date();
            const dateKey = now.toISOString().split('T')[0]; 
            const dateDisplay = now.toLocaleString();

            if(title && text) {
                const newArticle = { id: Date.now(), cat, title, text, dateKey, dateDisplay };
                allNews.unshift(newArticle);
                localStorage.setItem('myJournalNews', JSON.stringify(allNews));
                renderNews();
                document.getElementById('news-title').value = "";
                document.getElementById('news-text').value = "";
            }
        }

        function deleteNews(id) {
            allNews = allNews.filter(a => a.id !== id);
            localStorage.setItem('myJournalNews', JSON.stringify(allNews));
            renderNews();
        }

        function changeCategory(cat) {
            currentCategory = cat;
            document.getElementById('current-cat').innerText = cat === 'Tout' ? 'Toutes les infos' : cat;
            
            let items = document.getElementsByClassName('menu-item');
            for (let item of items) {
                item.classList.remove('active');
                if(item.innerText.includes(cat)) item.classList.add('active');
            }
            renderNews();
        }

        function resetDate() {
            document.getElementById('date-picker').value = "";
            renderNews();
        }

        function renderNews() {
            const container = document.getElementById('news-container');
            const selectedDate = document.getElementById('date-picker').value; // Format YYYY-MM-DD
            container.innerHTML = "";
            
            allNews.forEach(article => {
                const matchCat = (currentCategory === 'Tout' || article.cat === currentCategory);
                const matchDate = (selectedDate === "" || article.dateKey === selectedDate);

                if (matchCat && matchDate) {
                    container.innerHTML += `
                        <div class="news-card">
                            <span class="badge">${article.cat}</span>
                            <small> - ${article.dateDisplay}</small>
                            <button class="delete-btn" style="display:${isAdmin ? 'block' : 'none'}" onclick="deleteNews(${article.id})">Supprimer</button>
                            <h2>${article.title}</h2>
                            <p>${article.text}</p>
                        </div>
                    `;
                }
            });

            if (container.innerHTML === "") {
                container.innerHTML = "<p style='text-align:center; color:#888;'>Aucun article trouv√© pour cette s√©lection.</p>";
            }
        }

        renderNews();
    </script>
</body>
</html>
